
https://malware-traffic-analysis.net/2024/07/30/index.html

Executive summary
	On the 30th of July 2024, a Windows host used by Clack Collier was infected with the STRRAT malware.

Victim details
	ip - 172.16.1[.]66
	mac - 00:1e:64:ec:f3:08
	hostname - desktop-skbr25f    `(kerberos.CNameString and ip.addr == 172.16.1.66)`
	username - ccollier                   `(kerberos.CNameString and ip.addr == 172.16.1.66)`
	full name  - Clark Collier          `((ldap.AttributeDescription == "givenName") and ip.addr == 172.16.1.66)`

IOC's
	We need to create a filter to see what is going on. The filter needs to filter the following traffic:
		- Capture packets that are part of a http request
		- Capture the first process of the TLS handshake
		- Capture packets where the SYN flag is set but the ACK is not, these are used to initiate a new connection
		- Exclude packets from within the network (172.16.1.0/24) and exclude packets with a destination port of 443 or 80. This ensures we are only capturing SYN packets targeting other IP addresses or ports.
		- Exclude SSDP traffic.
	We can now see a TCP connection is being made between the victim and 141.98.10[.]79. If we follow this traffic we can see the STRRAT string in the packets indicating it is malware.
	We can also see the IP address is being checked on the infected host from `ip-api.com`



`(http.request or tls.handshake.type eq 1 or (tcp.flags.syn eq 1 and tcp.flags.ack eq 0 and !(ip.dst eq 172.16.1.0/24 or tcp.port eq 443 or tcp.port eq 80))) and !(ssdp)`
